<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>HealthMate Chatbot</title>
    <link
      rel="stylesheet"
      href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css"
    />
    <link
      rel="stylesheet"
      href="https://use.fontawesome.com/releases/v5.5.0/css/all.css"
    />
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
    <link
      rel="stylesheet"
      type="text/css"
      href="{{ url_for('static', filename='style.css') }}"
    />
  </head>
  <body>
    <div class="chat-container">
      <div class="chat-card">
        <div class="chat-header">
          <div class="chat-info">
            <div class="avatar">
              <img
                src="https://cdn-icons-png.flaticon.com/512/3774/3774299.png"
                alt="bot"
              />
              <span class="status-dot"></span>
            </div>
            <div class="details">
              <h5>HealthMate Chatbot</h5>
              <p>Your AI Medical Assistant</p>
              <p style="font-size: 12px; color: #ffd700; margin-top: -5px">
                AI Disclaimer: Not substitute for professional clinical
                guidance.
              </p>
            </div>
          </div>
        </div>

        <div id="messageFormeight" class="chat-body"></div>

        <div class="chat-footer">
          <form id="messageArea" class="input-group">
            <input
              type="text"
              id="text"
              name="msg"
              placeholder="Type your message..."
              autocomplete="off"
              class="form-control message-input"
              required
            />
            <div class="input-group-append">
              <button type="submit" id="send" class="btn send-btn">
                <i class="fas fa-paper-plane"></i>
              </button>
            </div>
          </form>
        </div>
      </div>
    </div>

    <script>
      $(document).ready(function () {
        $("#messageArea").on("submit", function (event) {
          const date = new Date();
          const time = date.toLocaleTimeString([], {
            hour: "2-digit",
            minute: "2-digit",
          });
          var rawText = $("#text").val();

          var userHtml = `
            <div class="message user">
                <div class="bubble">${rawText}</div>
                <span class="time">${time}</span>
            </div>`;

          $("#text").val("");
          $("#messageFormeight").append(userHtml);
          $("#messageFormeight").scrollTop(
            $("#messageFormeight")[0].scrollHeight
          );

          $.ajax({
            data: { msg: rawText },
            type: "POST",
            url: "/get",
          }).done(function (data) {
            var botHtml = `
                <div class="message bot">
                    <div class="avatar-small">
                        <img src="https://cdn-icons-png.flaticon.com/512/3774/3774299.png">
                    </div>
                    <div class="bubble">${data}</div>
                    <span class="time">${time}</span>
                </div>`;

            $("#messageFormeight").append(botHtml);
            $("#messageFormeight").scrollTop(
              $("#messageFormeight")[0].scrollHeight
            );
          });

          event.preventDefault();
        });
      });
    </script>
  </body>
</html>
